<?php

// TO DO:
// 1. fix everything
// 2. write at least two more questions
// 3. make suggestions based on questions

// front page link - question 1 and question 2 - success page //
function pastry_quiz_menu() {
    $items['quiz'] = array(
        'title' => 'What should I eat!?',
        'page callback' => 'drupal_get_form',
        'page arguments' => array('start_form'),
        'access callback' => TRUE,
        'type' => MENU_NORMAL_ITEM,
    );

    $items['quiz_question_1'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('quiz_form'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['quiz_question_2'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('quiz_form_2'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['quiz_results'] = array(
        'title' => 'Quiz Results!',
        'page callback' => 'quiz_success',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    return $items;
}

// first page form  //
function start_form() {
    $form['gluten'] = array(
        '#title' => 'Gluten Intollerance',
        '#type' => 'radios',
        '#description' => t('Are you gluten intollerant?'),
        '#options' => array(
            t('Yes'),
            t('No'),
        ),
        '#required' => TRUE,
    );

    $form['submit'] = array(
        '#type' => 'submit',
        '#value' => 'submit',
    );

    return $form;
}

// first page submit //
function start_form_submit($form, &$form_state) {
    $result = $form_state['values']['gluten'];
    $_SESSION['first_answer'] = $result;

  $form_state['redirect'] = 'quiz_question_1';
}

// second page form //
function quiz_form() {
    $result = $_SESSION['first_answer'];
    if ($result == "0") {

        $form['second_yes'] = array(
            '#title' => 'Gluten-free Choices',
            '#type' => 'radios',
            '#description' => t('Would you like extra sugar instead then?'),
            '#options' => array(
                t('Yes'),
                t('No'),
            ),
            '#required' => TRUE,
        );

        $form['submit'] = array(
            '#type' => 'submit',
            '#value' => 'submit',
        );
        return $form;


    } elseif ($result == "1") {

          $form['second_no'] = array(
              '#title' => 'Wheat Madness!!!',
              '#type' => 'radios',
              '#description' => t('Great, then choose a cookie!'),
              '#options' => array(
                  t('chocolate'),
                  t('Vanilla'),
              ),
              '#required' => TRUE,
          );

          $form['submit'] = array(
                  '#type' => 'submit',
                  '#value' => 'submit',
          );
          return $form;
    }


}

// second page submit //
function quiz_form_submit($form, &$form_state) {

    if ($form_state['values']['second_yes'] == "0"){
        $result_yes = $form_state['values']['second_yes'];
        $_SESSION['second_answer_yes'] = $result_yes;

    } elseif ($form_state['values']['second_no'] == "1") {
        $result_no = $form_state['values']['second_no'];
        $_SESSION['second_answer_no'] = $result_no;
        
    }
    $form_state['redirect'] = 'quiz_question_2';
}




// second page form //
function quiz_form_2() {

    $result = $_SESSION['first_answer'];
    if ($result == "0") {

        $form['second_yes'] = array(
            '#title' => 'Diabetes Delight',
            '#type' => 'radios',
            '#description' => t('How clogged up would you like your arteries?'),
            '#options' => array(
                t('Cupcaked up'),
                t('Caked up'),
            ),
            '#required' => TRUE,
        );

        $form['submit'] = array(
            '#type' => 'submit',
            '#value' => 'submit',
        );
        return $form;


    } elseif ($result == "1") {

          $form['second_no'] = array(
              '#title' => 'Little sugar, longer life!',
              '#type' => 'radios',
              '#description' => t('How about these sugar-free options?'),
              '#options' => array(
                  t('Cardboard Cookies'),
                  t('Plain Pastry'),
              ),
              '#required' => TRUE,
          );

          $form['submit'] = array(
                  '#type' => 'submit',
                  '#value' => 'submit',
          );
          return $form;
    }

}

// second page submit //
function quiz_form_2_submit($form, &$form_state) {
    $result_yes = $form_state['values']['yes'];
    $result_no = $form_state['values']['no'];

    $_SESSION['second_answer_yes'] = $result_yes;
    $_SESSION['second_answer_no'] = $result_no;
    $form_state['redirect'] = 'quiz_results';
}

// success page //
function quiz_success() {
  $gluten = $_SESSION['values']['gluten'];
  if ($gluten) {
    return '<p>get a donut!</p>';
  } else {
    return "<p>cool! we've got stuff for you too!/p>";
  }
}
