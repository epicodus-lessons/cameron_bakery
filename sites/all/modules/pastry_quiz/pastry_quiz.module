<?php

// TO DO:
// 1. fix everything
// 2. write at least two more questions
// 3. make suggestions based on questions

function pastry_quiz_menu() {
    $items['quiz'] = array(
        'title' => 'What should I eat!?',
        'page callback' => 'drupal_get_form',
        'page arguments' => array('start_form'),
        'access callback' => TRUE,
        'type' => MENU_NORMAL_ITEM,
    );

    $items['quiz_question_1'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('quiz1_form'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['quiz_question_2'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('quiz2_form'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );
    $items['quiz_question_3'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('quiz3_form'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['quiz_results'] = array(
        'title' => 'Quiz Results!',
        'page callback' => 'quiz_success',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    return $items;
}



// Start Quiz Submit
function start_form() {
    $form['submit'] = array(
        '#type' => 'submit',
        '#value' => 'Start Quiz',
    );
    return $form;
}

function start_form_submit($form, &$form_state) {
    $form_state['redirect'] = 'quiz_question_1';
}


// First Question
function quiz1_form() {
    $form['gluten'] = array(
    '#title' => 'Gluten Intollerance',
    '#type' => 'radios',
    '#description' => t('Are you gluten intolerant?'),
    '#options' => array(
    t('Yes'),
    t('No'),
    ),
    '#required' => TRUE,
    );
    $form['submit'] = array(
    '#type' => 'submit',
    '#value' => 'submit',
    );
    return $form;
}
function quiz1_form_submit($form, &$form_state) {
    $gluten = $form_state['values']['gluten'];
    $_SESSION['gluten'] = $gluten;
    $form_state['redirect'] = 'quiz_question_2';

}


// Second Question
function quiz2_form() {
    $form['lactose'] = array(
    '#title' => 'Lactose Intollerance',
    '#type' => 'radios',
    '#description' => t('Are you lactose intolerant?'),
    '#options' => array(
    t('Yes'),
    t('No'),
    ),
    '#required' => TRUE,
    );

    $form['submit'] = array(
    '#type' => 'submit',
    '#value' => 'submit',
    );
    return $form;
}
function quiz2_form_submit($form, &$form_state) {
    $lactose = $form_state['values']['lactose'];
    $_SESSION['lactose'] = $lactose;
    $form_state['redirect'] = 'quiz_question_3';
}


// Third Question
function quiz3_form() {
    $form['chocolate'] = array(
    '#title' => 'Do you like chocolate?',
    '#type' => 'radios',
    '#description' => t('Do you like chocolate?'),
    '#options' => array(
    t('Yes'),
    t('No'),
    ),
    '#required' => TRUE,
    );

    $form['submit'] = array(
    '#type' => 'submit',
    '#value' => 'submit',
    );
    return $form;
}
function quiz3_form_submit($form, &$form_state) {
    $chocolate = $form_state['values']['chocolate'];
    $_SESSION['chocolate'] = $chocolate;
    $form_state['redirect'] = 'quiz_results';
}



// Result
function quiz_success() {
    $lactose = $_SESSION['lactose'];
    $gluten = $_SESSION['gluten'];
    $chocolate = $_SESSION['chocolate'];
    if($lactose === "0" && $gluten === "0" && $chocolate ==="0") {
        return "<p>Trie our new Vegan and Allergic free Chocolate Bars for just $2 each!</p>";
    } else  if($lactose === "0" && $gluten === "0" && $chocolate ==="1"){
        return "<p>Trye our new Vegan and Allergic free Strawberry cakes! They are simply delicious!</p>";
    } else  if($lactose === "1" && $gluten === "0" && $chocolate ==="1"){
        return "<p>You are in the right place! We have gluten free brownies half of the price until Jun 21!</p>";
    } else  if($lactose === "0" && $gluten === "1" && $chocolate ==="1"){
        return "<p>We know how hard is to find lactose chocolate cakes, that's why he have this huge selection of them in all of ours stores! Just come and trie!</p>";
    } else {
        return ("<p>Trie our favorite cookies for half price this month!!</p>" );
    }

}
